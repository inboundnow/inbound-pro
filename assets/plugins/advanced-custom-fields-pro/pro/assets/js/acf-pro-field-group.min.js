!function($){acf.field_group_pro=acf.model.extend({actions:{open_field:"update_field_parent",sortstop:"update_field_parent",duplicate_field:"duplicate_field",delete_field:"delete_field",change_field_type:"change_field_type"},fix_conditional_logic:function(e){var a={};e.each(function(){a[$(this).attr("data-orig")]=$(this).attr("data-key")}),e.find(".conditional-rule-param").each(function(){var e=$(this).val();e in a&&($(this).find('option[value="'+a[e]+'"]').exists()||$(this).append('<option value="'+a[e]+'">'+a[e]+"</option>"),$(this).val(a[e]))})},update_field_parent:function(e){if(e.hasClass("acf-field-object")){var a=e.parent().closest(".acf-field-object"),t=acf.get("post_id");a.exists()&&(t=acf.field_group.get_field_meta(a,"ID"),t||(t=acf.field_group.get_field_meta(a,"key"))),acf.field_group.update_field_meta(e,"parent",t),acf.do_action("update_field_parent",e,a)}},duplicate_field:function(e){var a=e.find(".acf-field-object").not('[data-id="acfcloneindex"]');a.exists()&&(a.each(function(){var e=$(this).parent().closest(".acf-field-object"),a=acf.field_group.get_field_meta(e,"key");acf.field_group.wipe_field($(this)),acf.field_group.update_field_meta($(this),"parent",a),acf.field_group.save_field($(this))}),this.fix_conditional_logic(a))},delete_field:function(e){e.find(".acf-field-object").each(function(){acf.field_group.delete_field($(this),!1)})},change_field_type:function(e){e.find(".acf-field-object").each(function(){acf.field_group.delete_field($(this),!1)})}});var e=acf.model.extend({actions:{open_field:"render",change_field_type:"render"},events:{'change .acf-field[data-name="layout"] input':"render",'focus .acf-field[data-name="collapsed"] select':"focus"},event:function(e){return e.$el.closest(".acf-field-object")},render:function(e){if("repeater"==e.attr("data-type")){var a=e.find('> .settings > table > tbody > [data-name="layout"] input:checked'),t=e.find(".acf-field-list:first");t.attr("data-layout",a.val()),this.focus(e)}},focus:function(e){var a=e.find('> .settings > table > tbody > [data-name="collapsed"] select'),t=e.find(".acf-field-list:first"),i=[];i.push({label:a.find('option[value=""]').text(),value:""}),t.children(".acf-field-object").not('[data-id="acfcloneindex"]').each(function(){var e=$(this);i.push({label:e.find(".field-label:first").val(),value:e.attr("data-key")})}),acf.render_select(a,i)}}),a=acf.model.extend({actions:{open_field:"render",change_field_type:"render",update_field_parent:"update_field_parent"},events:{"change .acf-fc-meta-display select":"_layout","blur .acf-fc-meta-label input":"_label",'click a[data-name="acf-fc-add"]':"_add",'click a[data-name="acf-fc-duplicate"]':"_duplicate",'click a[data-name="acf-fc-delete"]':"_delete"},event:function(e){return e.$el.closest('tr[data-name="fc_layout"]')},render:function(e){var a=this;if("flexible_content"==e.attr("data-type")){var t=e.find("> .settings > table > tbody");t.hasClass("ui-sortable")||t.sortable({items:'> tr[data-name="fc_layout"]',handle:'[data-name="acf-fc-reorder"]',forceHelperSize:!0,forcePlaceholderSize:!0,scroll:!0,start:function(e,a){acf.do_action("sortstart",a.item,a.placeholder)},stop:function(a,t){acf.do_action("sortstop",t.item,t.placeholder),acf.field_group.save_field(e)}}),t.children('tr[data-name="fc_layout"]').each(function(){a.render_layout($(this))})}},render_layout:function(e){var a=this,t=e.find(".acf-fc-meta-key:first input"),i=e.find(".acf-fc-meta-display:first select"),f=e.find(".acf-field-list:first");t.val(e.attr("data-id")),f.attr("data-layout",i.val());var l=e.attr("data-id");f.children(".acf-field-object").each(function(){a.render_meta($(this),l)})},render_meta:function(e,a){acf.field_group.update_field_meta(e,"parent_layout",a)},update_field_parent:function(e,a){if(!a.exists())return void acf.field_group.delete_field_meta(e,"parent_layout");if("flexible_content"!=a.attr("data-type"))return void acf.field_group.delete_field_meta(e,"parent_layout");var t=e.closest('tr[data-name="fc_layout"]');this.render_meta(e,t.attr("data-id")),acf.field_group.save_field(e)},_layout:function(e){this.render_layout(e)},_add:function(e){$el2=acf.duplicate(e),$el2.find(".acf-field-object").not('[data-id="acfcloneindex"]').remove(),$el2.find(".no-fields-message").show(),$el2.find(".acf-fc-meta input").val(""),e.after($el2),this.render_layout($el2),acf.field_group.save_field(e.closest(".acf-field-object"))},_duplicate:function(e){$el2=acf.duplicate(e);var a=$el2.find(".acf-field-object").not('[data-id="acfcloneindex"]');a.each(function(){acf.field_group.wipe_field($(this)),acf.field_group.save_field($(this))}),acf.field_group_pro.fix_conditional_logic(a),e.after($el2),this.render_layout($el2),acf.field_group.save_field(e.closest(".acf-field-object"))},_delete:function(e){return 0==e.siblings('tr[data-name="fc_layout"]').length?(alert(acf._e("flexible_content","layout_warning")),!1):(e.find(".acf-field-object").not('[data-id="acfcloneindex"]').each(function(){acf.field_group.delete_field($(this),!1)}),acf.remove_tr(e),void acf.field_group.save_field(e.closest(".acf-field-object")))},_label:function(e){var a=e.find(".acf-fc-meta-label:first input"),t=e.find(".acf-fc-meta-name:first input");if(""==t.val()){var i=a.val();i=acf.str_sanitize(i),t.val(i).trigger("change")}}})}(jQuery);
